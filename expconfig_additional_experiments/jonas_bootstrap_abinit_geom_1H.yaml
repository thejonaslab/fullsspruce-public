exp_data:
  data :
    - filename: processed_dbs/shifts.gdb17-stereo-dft.b3lyp-631gd.0-48a-e2-c16.m6311_smd_cdcl.48_48_HCONFSPCl_wcharge_1H_ch3avg.dataset.pickle
      phase: train
      filter_max_n : 64
      extra_features:
        - filename: distance_features/gdb17-stereo-0_PT_distances_means.pickle
          field : mean_distance_mat
      
    - filename: processed_dbs/shifts.gdb17-stereo-dft.b3lyp-631gd.0-48a-e2-c16.m6311_smd_cdcl.48_48_HCONFSPCl_wcharge_1H_ch3avg.dataset.pickle
      phase: test
      filter_max_n : 64
      extra_features:
        - filename: distance_features/gdb17-stereo-0_PT_distances_means.pickle
          field : mean_distance_mat

  extra_data : []
  filter_max_n: 0
  cv_split :
    how: morgan_fingerprint_mod
    mod : 10
    test : [0, 1]

tblogdir: tblogs.baseline

pred_config:
  vert:
    - data_field: spect_dict
      index: 0 

net_name: nets.GraphVertConfigBootstrapWithMultiMax

validate_config:
  shift_uncertain_validate:
    fields:
      - 1H
      
  
net_params:
  init_noise : 0.0
  init_bias: 0.0
  resnet : True
  int_d :  128
  layer_n : 4
  agg_func : goodmax
  gml_class: GraphMatLayers
  gml_config:
    layer_class: GraphMatLayerExpressionWNorm2
    layer_config:
      dropout: 0.01
      per_nonlin: null
      post_agg_nonlin: relu
      post_agg_norm: layer
      norm_by_neighbors: True
      cross_term_agg_func: sum
      terms:
        -
          power: 1
          diag: False
        # -
        #   power: 3
        #   diag: True
        # -
        #   power: 2
        #   diag: False

  force_lin_init : True
  g_feature_n : -1
  resnet_out : True
  out_std : False
  inner_norm : null
  input_norm : batch
  resnet_blocks : [3,]
  resnet_d: 128
  mixture_n: 10
  mixture_num_obs_per: 5
  out_std_exp : False
  OUT_DIM : 1 # update
  use_random_subsets: False

batch_size: 32

tgt_max_n: 64


opt_params:
  optimizer : adam 
  lr : 5.0e-4
  scheduler_gamma : 0.9
  eps : 1.0e-8 
  scheduler_step_size : 10
  
clip_grad_value : 1.0e1
    
seed : 1234

dataset_hparams:
  feat_vect_args:
    mmff_atom_types_onehot : False
    feat_atomicno: False

  adj_args:
    add_identity: False
    norm_adj: False
    edge_bin: True
  feat_mol_geom_args:
    feat_distances: True
    distance_feature_func: 'inv'
    feat_r_pow: [-1.00, -1.25, -1.50, -1.75, -2.00, -2.25, -2.50, -2.75, -3.00, -3.25, -3.50, -3.75, -4.00, -4.25, -4.50, -4.75, -5.00, -5.25, -5.50, -5.75, -6.00, -6.25, -6.50, -6.75, -7.00, -7.25, -7.50, -7.75, -8.00, -8.25, -8.50, -8.75, -9.00, -9.25, -9.50, -9.75, ]
  other_args:
    combine_mat_feat_adj: True

loss_params:
  loss_name : NoUncertainLoss
  norm : huber
  scale : 1.0

max_epochs: 501
